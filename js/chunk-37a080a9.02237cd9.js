(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37a080a9"],{"2f21":function(e,t,a){"use strict";var o=a("79e5");e.exports=function(e,t){return!!e&&o(function(){t?e.call(null,function(){},1):e.call(null)})}},"55dd":function(e,t,a){"use strict";var o=a("5ca1"),r=a("d8e8"),i=a("4bf8"),l=a("79e5"),n=[].sort,s=[1,2,3];o(o.P+o.F*(l(function(){s.sort(void 0)})||!l(function(){s.sort(null)})||!a("2f21")(n)),"Array",{sort:function(e){return void 0===e?n.call(i(this)):n.call(i(this),r(e))}})},"79ec":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-tabs",{staticClass:"ma-3",attrs:{grow:"",color:"blue"}},[a("v-tab",{attrs:{href:"#tab-1"}},[e._v("加入房间")]),a("v-tab",{attrs:{href:"#tab-2"}},[e._v("建立房间")]),a("v-tabs-items",[a("v-tab-item",{attrs:{value:"tab-1"}},[a("v-card",{attrs:{flat:""}},[a("div",{staticClass:"pa-3"},[a("v-text-field",{attrs:{label:"请输入你要加入的房间号",required:""},model:{value:e.roomNumber,callback:function(t){e.roomNumber=t},expression:"roomNumber"}}),a("v-btn",{staticClass:"ma-0",attrs:{color:"red lighten-2",loading:e.loading},on:{click:e.loadRoom}},[e._v("进入")])],1)]),a("v-tabs",{staticClass:"mt-3",attrs:{grow:"",color:"blue"}},[a("v-tab",[e._v("近期加入过的房间")]),a("v-tabs-items",[a("v-tab-item",[a("v-data-table",{attrs:{headers:e.joinedRooms.headers,items:e.joinedRooms.items,pagination:e.joinedRooms.pagination},on:{"update:pagination":function(t){e.$set(e.joinedRooms,"pagination",t)}},scopedSlots:e._u([{key:"items",fn:function(t){return[a("tr",{on:{click:function(a){e.roomNumber=t.item.roomNumber,e.bottomSheet=!0}}},[a("td",{staticClass:"ma-0 px-2"},[e._v(e._s(t.item.roomNumber))]),a("td",{staticClass:"ma-0 px-2"},[e._v(e._s(t.item.roomPrize))]),a("td",{staticClass:"ma-0 px-2"},[e._v(e._s(t.item.roomShareSupply))]),a("td",{staticClass:"ma-0 px-2"},[e._v(e._s(t.item.sharePurchased))])])]}}])})],1)],1)],1)],1),a("v-tab-item",{attrs:{value:"tab-2"}},[a("v-card",{attrs:{flat:""}},[a("form",{staticClass:"pa-3"},[a("v-text-field",{attrs:{type:"number",label:"夺宝标的（ETH）",suffix:"ether",required:""},model:{value:e.roomPrize,callback:function(t){e.roomPrize=t},expression:"roomPrize"}}),a("v-text-field",{attrs:{type:"number",label:"夺标份额（把标的奖金分成多少份）",suffix:"份",required:""},model:{value:e.roomShareSupply,callback:function(t){e.roomShareSupply=t},expression:"roomShareSupply"}}),a("v-btn",{staticClass:"ma-0",attrs:{color:"blue"},on:{click:e.createRoom}},[e._v("确认")])],1)]),a("v-tabs",{staticClass:"mt-3",attrs:{grow:"",color:"blue"}},[a("v-tab",[e._v("近期建立的房间")]),a("v-tabs-items",[a("v-tab-item",[a("v-data-table",{attrs:{headers:e.createdRooms.headers,items:e.createdRooms.items,pagination:e.createdRooms.pagination},on:{"update:pagination":function(t){e.$set(e.createdRooms,"pagination",t)}},scopedSlots:e._u([{key:"items",fn:function(t){return[a("tr",{on:{click:function(a){e.roomNumber=t.item.roomNumber,e.bottomSheet=!0}}},[a("td",{staticClass:"ma-0 px-2"},[e._v(e._s(t.item.roomNumber))]),a("td",{staticClass:"ma-0 px-2"},[e._v(e._s(t.item.roomPrize))]),a("td",{staticClass:"ma-0 px-2"},[e._v(e._s(t.item.roomShareSupply))])])]}}])})],1)],1)],1)],1),a("v-dialog",{model:{value:e.viewDialog,callback:function(t){e.viewDialog=t},expression:"viewDialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline grey lighten-2",attrs:{"primary-title":""}},[e._v("房号："+e._s(e.roomNumber))]),a("v-card-text",[a("v-text-field",{attrs:{label:"奖金：",suffix:"ether",disabled:""},model:{value:e.roomPrize,callback:function(t){e.roomPrize=t},expression:"roomPrize"}}),a("v-text-field",{attrs:{label:"剩余：",suffix:"份",disabled:""},model:{value:e.roomShareSupply,callback:function(t){e.roomShareSupply=t},expression:"roomShareSupply"}}),e.roomShareSupply<=0?a("v-text-field",{attrs:{label:"赢家：",disabled:""},model:{value:e.roomWinner,callback:function(t){e.roomWinner=t},expression:"roomWinner"}}):e._e(),e.roomShareSupply>0?a("v-text-field",{attrs:{type:"number",label:"请输入你要购买的份额",suffix:"份",required:""},model:{value:e.roomShares,callback:function(t){e.roomShares=t},expression:"roomShares"}}):e._e()],1),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.viewDialog=!1}}},[e._v("关闭")]),e.roomShareSupply>0?a("v-btn",{attrs:{color:"red lighten-2"},on:{click:e.buyShares}},[e._v("购买")]):e._e()],1)],1)],1),a("v-dialog",{model:{value:e.referralDialog,callback:function(t){e.referralDialog=t},expression:"referralDialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline grey lighten-2",attrs:{"primary-title":""}},[e._v("房号："+e._s(e.roomNumber))]),a("v-card-text",[a("v-text-field",{attrs:{label:"你的推荐地址：","append-icon":"assignment"},on:{"click:append":e.copyReferralUrl},model:{value:e.referralUrl,callback:function(t){e.referralUrl=t},expression:"referralUrl"}})],1),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.referralDialog=!1}}},[e._v("关闭")])],1)],1)],1),a("v-bottom-sheet",{model:{value:e.bottomSheet,callback:function(t){e.bottomSheet=t},expression:"bottomSheet"}},[a("v-list",[a("v-list-tile",[a("v-list-tile-title",[a("v-layout",{attrs:{"justify-center":""},on:{click:function(t){e.bottomSheet=!1,e.loadRoom()}}},[e._v("查看")])],1)],1),a("v-list-tile",[a("v-list-tile-title",[a("v-layout",{attrs:{"justify-center":""},on:{click:function(t){e.bottomSheet=!1,e.loadReferralLink()}}},[e._v("推荐")])],1)],1)],1)],1)],1)],1)},r=[],i=(a("55dd"),{name:"Game1",data:function(){return{loading:!1,viewDialog:!1,referralDialog:!1,bottomSheet:!1,roomNumber:0,roomPrize:0,roomShareSupply:0,roomSharePrice:0,roomShares:0,roomWinner:0,account:0,referrer:this.$route.params.referrer,referralUrl:"",joinedRooms:{headers:[{text:"房号",value:"roomNumber",class:"ma-0 px-2"},{text:"奖金 (ether)",value:"roomPrize",sortable:!1,class:"ma-0 px-2"},{text:"剩余 (份)",value:"roomShareSupply",sortable:!1,class:"ma-0 px-2"},{text:"购买 (份)",value:"sharePurchased",sortable:!1,class:"ma-0 px-2"}],items:[],pagination:{descending:!0,sortBy:"roomNumber"}},createdRooms:{headers:[{text:"房号",value:"roomNumber",class:"ma-0 px-2"},{text:"奖金 (ether)",value:"roomPrize",sortable:!1,class:"ma-0 px-2"},{text:"剩余 (份)",value:"roomShareSupply",sortable:!1,class:"ma-0 px-2"}],items:[],pagination:{descending:!0,sortBy:"roomNumber"}}}},created:function(){var e=this;e.ethereum.eth.getAccounts(function(t,a){if(!t){e.$data.account=a[0];var o=e.ethereum.contract("LotboGameOne");o.Joined({player:e.$data.account},{fromBlock:6351611,toBlock:"latest"}).get(function(t,a){var r=function(){var t=a[i].args.roomNumber;o.getRoomInfo.call(t,function(o,r){!o&&r&&e.$data.joinedRooms.items.push({roomNumber:t.toNumber(),roomPrize:e.ethereum.fromWei(r[0]).toNumber(),roomShareSupply:r[1].toNumber(),sharePurchased:a[i].args.sharePurchased.toNumber()})})};for(var i in a)r()}),o.Created({creater:e.$data.account},{fromBlock:6351611,toBlock:"latest"}).get(function(t,a){var r=function(){var t=a[i].args.roomNumber;o.getRoomInfo.call(t,function(a,o){!a&&o&&e.$data.createdRooms.items.push({roomNumber:t.toNumber(),roomPrize:e.ethereum.fromWei(o[0]).toNumber(),roomShareSupply:o[1].toNumber()})})};for(var i in a)r()})}})},computed:{loadJoinedRooms:function(){return this.$data.joinedRooms.items.sort(function(e,t){return t.roomNumber-e.roomNumber})}},methods:{loadReferralLink:function(){var e=this;e.$data.referralDialog=!0,e.$data.referralUrl="https://lotbo.club/game1/"+e.$data.roomNumber+"/"+e.$data.account},copyReferralUrl:function(){var e=this;e.$copyText(e.$data.referralUrl).then(function(e){alert("推荐链接已复制。")})},loadRoom:function(){var e=this;e.$data.loading=!0;var t=e.ethereum.contract("LotboGameOne");t.getRoomInfo.call(e.$data.roomNumber,function(t,a){if(e.$data.loading=!1,t||a[0]<=0)return alert("没有找到游戏房间，请输入正确的房间号。"),!1;e.$data.viewDialog=!0,e.$data.roomPrize=e.ethereum.fromWei(a[0]),e.$data.roomShareSupply=a[1],e.$data.roomSharePrice=a[2],e.$data.roomShares=a[1],e.$data.roomWinner=a[3]})},buyShares:function(){var e=this;if(e.$data.roomShares>e.$data.roomShareSupply)return alert("购买份额不能大于该房间的夺宝剩余份额。"),e.$data.roomShares=e.$data.roomShareSupply,!1;e.ethereum.eth.getAccounts(function(t,a){if(!t){e.$data.account=a[0];var o=e.$data.roomShares*e.$data.roomSharePrice,r=e.ethereum.contract("LotboGameOne");r.join.sendTransaction(e.$data.roomNumber,e.$data.referrer,{from:e.$data.account,value:o},function(t,a){t||(e.$data.viewDialog=!1)})}})},createRoom:function(){var e=this;e.ethereum.eth.getAccounts(function(t,a){if(!t){e.$data.account=a[0];var o=e.ethereum.contract("LotboBroker");o.exists.call(e.$data.account,function(t,a){if(t||!a)alert("只有游戏经纪人才可以建立房间哦！");else{var o=e.ethereum.contract("LotboGameOne");o.create.sendTransaction(e.ethereum.toWei(e.$data.roomPrize,"ether"),e.$data.roomShareSupply,{from:e.$data.account},function(e,t){e||console.log(t)})}})}})}}}),l=i,n=a("2877"),s=Object(n["a"])(l,o,r,!1,null,null,null);s.options.__file="Game1.vue";t["default"]=s.exports}}]);